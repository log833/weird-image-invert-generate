<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Weird Image Invert Generate</title>
<link rel="icon" href="icon.png" type="image/png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: white;
    text-align: center;
    padding: 20px;
  }

  input, button {
    margin: 10px 0;
  }

  canvas {
    max-width: 100%;
    border: 1px solid #555;
    margin-top: 10px;
    display: none;
  }

  #loading {
    display: none;
    margin-top: 15px;
    font-size: 18px;
    opacity: 0.8;
  }

  .controls {
    display: none;
    margin-top: 15px;
  }
</style>
</head>

<body>

<h2>Weird Image Invert Generate</h2>

<input type="file" accept="image/*" id="upload">

<div id="loading">Loading...</div>

<canvas id="canvas"></canvas>

<div class="controls" id="controls">
  <div>
    Invert Strength:
    <input type="range" id="invert" min="0" max="100" value="100">
  </div>
  <button id="download">Download</button>
</div>

<script>
const upload = document.getElementById("upload");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const loading = document.getElementById("loading");
const controls = document.getElementById("controls");
const invertSlider = document.getElementById("invert");
const downloadBtn = document.getElementById("download");

let originalData = null;

upload.addEventListener("change", () => {
  const file = upload.files[0];
  if (!file) return;

  loading.style.display = "block";
  canvas.style.display = "none";
  controls.style.display = "none";

  const img = new Image();
  img.onload = () => {
    canvas.width = img.width;
    canvas.height = img.height;

    ctx.drawImage(img, 0, 0);
    originalData = ctx.getImageData(0, 0, canvas.width, canvas.height);

    applyInvert();

    loading.style.display = "none";
    canvas.style.display = "block";
    controls.style.display = "block";
  };

  img.src = URL.createObjectURL(file);
});

function applyInvert() {
  if (!originalData) return;

  const strength = invertSlider.value / 100;

  const imgData = new ImageData(
    new Uint8ClampedArray(originalData.data),
    originalData.width,
    originalData.height
  );

  const d = imgData.data;

  for (let i = 0; i < d.length; i += 4) {
    d[i]     = d[i]     + (255 - d[i]     - d[i]) * strength; // R
    d[i + 1] = d[i + 1] + (255 - d[i + 1] - d[i + 1]) * strength; // G
    d[i + 2] = d[i + 2] + (255 - d[i + 2] - d[i + 2]) * strength; // B
  }

  ctx.putImageData(imgData, 0, 0);
}

invertSlider.addEventListener("input", applyInvert);

downloadBtn.addEventListener("click", () => {
  const link = document.createElement("a");
  link.download = "invert9_image.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
});
</script>

<h3>v1.0.3</h3>

</body>
</html>
