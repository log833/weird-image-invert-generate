<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Weird Image Invert Generate</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: white;
    text-align: center;
    padding: 20px;
  }

  input, button {
    margin: 10px 0;
  }

  canvas {
    max-width: 100%;
    border: 1px solid #555;
    margin-top: 10px;
    display: none;
  }

  #loading {
    display: none;
    margin-top: 15px;
    font-size: 18px;
    opacity: 0.8;
  }

  .controls {
    display: none;
    margin-top: 15px;
  }
</style>
</head>

<body>

<h2>Weird Image Invert Generate</h2>

<input type="file" accept="image/*" id="upload">

<div id="loading">Loading...</div>

<canvas id="canvas"></canvas>

<div class="controls" id="controls">
  <div>
    Opacity:
    <input type="range" id="opacity" min="0" max="100" value="100">
  </div>
  <button id="download">Download</button>
</div>

<script>
const upload = document.getElementById("upload");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const loading = document.getElementById("loading");
const controls = document.getElementById("controls");
const opacitySlider = document.getElementById("opacity");
const downloadBtn = document.getElementById("download");

let invertedImageData = null;

upload.addEventListener("change", () => {
  const file = upload.files[0];
  if (!file) return;

  loading.style.display = "block";
  canvas.style.display = "none";
  controls.style.display = "none";

  const img = new Image();
  img.onload = () => {
    canvas.width = img.width;
    canvas.height = img.height;

    ctx.globalAlpha = 1;
    ctx.drawImage(img, 0, 0);

    invertedImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = invertedImageData.data;

    for (let i = 0; i < data.length; i += 4) {
      data[i]     = 255 - data[i];
      data[i + 1] = 255 - data[i + 1];
      data[i + 2] = 255 - data[i + 2];
    }

    drawWithOpacity();

    loading.style.display = "none";
    canvas.style.display = "block";
    controls.style.display = "block";
  };

  img.src = URL.createObjectURL(file);
});

function drawWithOpacity() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.globalAlpha = opacitySlider.value / 100;
  ctx.putImageData(invertedImageData, 0, 0);
  ctx.globalAlpha = 1;
}

opacitySlider.addEventListener("input", drawWithOpacity);

downloadBtn.addEventListener("click", () => {
  const link = document.createElement("a");
  link.download = "invert9_image.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
});
</script>

</body>
</html>
